(()=>{var e={};e.id=296,e.ids=[296],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},32615:e=>{"use strict";e.exports=require("http")},35240:e=>{"use strict";e.exports=require("https")},55315:e=>{"use strict";e.exports=require("path")},68621:e=>{"use strict";e.exports=require("punycode")},76162:e=>{"use strict";e.exports=require("stream")},17360:e=>{"use strict";e.exports=require("url")},71568:e=>{"use strict";e.exports=require("zlib")},26287:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>l.a,__next_app__:()=>m,originalPathname:()=>x,pages:()=>o,routeModule:()=>p,tree:()=>c}),s(41428),s(41287),s(55582);var r=s(26818),a=s(65949),i=s(50153),l=s.n(i),n=s(1667),d={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>n[e]);s.d(t,d);let c=["",{children:["admin",{children:["subscriptions",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,41428)),"/workspace/socialpro-saas/app/admin/subscriptions/page.tsx"]}]},{}]},{metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,60291))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,41287)),"/workspace/socialpro-saas/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,55582,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,60291))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],o=["/workspace/socialpro-saas/app/admin/subscriptions/page.tsx"],x="/admin/subscriptions/page",m={require:s,loadChunk:()=>Promise.resolve()},p=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/admin/subscriptions/page",pathname:"/admin/subscriptions",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},82627:(e,t,s)=>{Promise.resolve().then(s.t.bind(s,18809,23)),Promise.resolve().then(s.t.bind(s,42299,23)),Promise.resolve().then(s.t.bind(s,28633,23)),Promise.resolve().then(s.t.bind(s,50991,23)),Promise.resolve().then(s.t.bind(s,97202,23)),Promise.resolve().then(s.t.bind(s,45558,23))},60444:(e,t,s)=>{Promise.resolve().then(s.bind(s,62257))},69696:()=>{},52032:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});let r=(0,s(5649).Z)("credit-card",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]])},9273:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});let r=(0,s(5649).Z)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},60244:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});let r=(0,s(5649).Z)("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]])},86173:(e,t,s)=>{"use strict";s.d(t,{Z:()=>r});let r=(0,s(5649).Z)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},4817:(e,t,s)=>{"use strict";var r=s(76875);s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}})},62257:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>m});var r=s(84208),a=s(55159),i=s(53036),l=s(4817),n=s(52032),d=s(60244);let c=(0,s(5649).Z)("dollar-sign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);var o=s(9273),x=s(86173);function m(){(0,l.useRouter)();let[e,t]=(0,a.useState)(!0),[s,m]=(0,a.useState)([]),[p,h]=(0,a.useState)([]),[u,g]=(0,a.useState)("all"),[y,b]=(0,a.useState)("all"),[v,j]=(0,a.useState)({total:0,active:0,revenue:0}),f=async()=>{try{let{data:e,error:t}=await i.O.from("subscriptions").select("*").order("created_at",{ascending:!1});if(t)throw t;if(e){let t=await Promise.all(e.map(async e=>{let{data:t}=await i.O.from("profiles").select("full_name").eq("id",e.user_id).single(),{data:s}=await i.O.auth.admin.getUserById(e.user_id);return{...e,user_name:t?.full_name||"غير محدد",user_email:s?.user?.email||"غير متوفر"}}));m(t),h(t);let s=t.filter(e=>"active"===e.status).length;j({total:t.length,active:s,revenue:299*s})}}catch(e){console.error("خطأ في تحميل الاشتراكات:",e)}finally{t(!1)}},N=async e=>{if(confirm("هل أنت متأكد من تجديد هذا الاشتراك؟"))try{let t=new Date;t.setMonth(t.getMonth()+1);let{error:s}=await i.O.from("subscriptions").update({status:"active",end_date:t.toISOString()}).eq("id",e);if(s)throw s;alert("تم تجديد الاشتراك بنجاح"),f()}catch(e){console.error("خطأ في تجديد الاشتراك:",e),alert("حدث خطأ أثناء التجديد")}},w=async e=>{if(confirm("هل أنت متأكد من إلغاء هذا الاشتراك؟"))try{let{error:t}=await i.O.from("subscriptions").update({status:"cancelled"}).eq("id",e);if(t)throw t;alert("تم إلغاء الاشتراك بنجاح"),f()}catch(e){console.error("خطأ في إلغاء الاشتراك:",e),alert("حدث خطأ أثناء الإلغاء")}},_=e=>r.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${{active:"bg-green-100 text-green-700",expired:"bg-red-100 text-red-700",cancelled:"bg-gray-100 text-gray-700"}[e]||""}`,children:{active:"نشط",expired:"منتهي",cancelled:"ملغي"}[e]||e}),k=e=>({free:"مجاني",monthly:"شهري",annual:"سنوي",lifetime:"مدى الحياة"})[e]||e;return e?r.jsx("div",{className:"flex items-center justify-center min-h-screen",children:r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"})}):r.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsxs)("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-2",children:[r.jsx(n.Z,{className:"w-8 h-8"}),"إدارة الاشتراكات"]}),r.jsx("p",{className:"text-gray-600 mt-1",children:"مراقبة وإدارة اشتراكات المستخدمين"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[r.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"إجمالي الاشتراكات"}),r.jsx("p",{className:"text-3xl font-bold text-gray-900",children:v.total})]}),r.jsx(n.Z,{className:"w-8 h-8 text-gray-400"})]})}),r.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"الاشتراكات النشطة"}),r.jsx("p",{className:"text-3xl font-bold text-green-600",children:v.active})]}),r.jsx(d.Z,{className:"w-8 h-8 text-green-400"})]})}),r.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"الإيرادات المتوقعة"}),(0,r.jsxs)("p",{className:"text-3xl font-bold text-purple-600",children:["$",v.revenue]})]}),r.jsx(c,{className:"w-8 h-8 text-purple-400"})]})})]}),r.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4 mb-6",children:(0,r.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[r.jsx("div",{className:"flex-1",children:(0,r.jsxs)("select",{value:u,onChange:e=>g(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",children:[r.jsx("option",{value:"all",children:"جميع الحالات"}),r.jsx("option",{value:"active",children:"نشط"}),r.jsx("option",{value:"expired",children:"منتهي"}),r.jsx("option",{value:"cancelled",children:"ملغي"})]})}),r.jsx("div",{className:"flex-1",children:(0,r.jsxs)("select",{value:y,onChange:e=>b(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",children:[r.jsx("option",{value:"all",children:"جميع الخطط"}),r.jsx("option",{value:"free",children:"مجاني"}),r.jsx("option",{value:"monthly",children:"شهري"}),r.jsx("option",{value:"annual",children:"سنوي"}),r.jsx("option",{value:"lifetime",children:"مدى الحياة"})]})})]})}),r.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:r.jsx("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full",children:[r.jsx("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[r.jsx("th",{className:"px-6 py-3 text-right text-sm font-semibold text-gray-700",children:"المستخدم"}),r.jsx("th",{className:"px-6 py-3 text-right text-sm font-semibold text-gray-700",children:"الخطة"}),r.jsx("th",{className:"px-6 py-3 text-right text-sm font-semibold text-gray-700",children:"الحالة"}),r.jsx("th",{className:"px-6 py-3 text-right text-sm font-semibold text-gray-700",children:"تاريخ البدء"}),r.jsx("th",{className:"px-6 py-3 text-right text-sm font-semibold text-gray-700",children:"تاريخ الانتهاء"}),r.jsx("th",{className:"px-6 py-3 text-right text-sm font-semibold text-gray-700",children:"التجديد التلقائي"}),r.jsx("th",{className:"px-6 py-3 text-right text-sm font-semibold text-gray-700",children:"الإجراءات"})]})}),r.jsx("tbody",{className:"divide-y divide-gray-200",children:p.map(e=>(0,r.jsxs)("tr",{className:"hover:bg-gray-50 transition-colors",children:[r.jsx("td",{className:"px-6 py-4",children:(0,r.jsxs)("div",{children:[r.jsx("p",{className:"font-medium text-gray-900",children:e.user_name}),r.jsx("p",{className:"text-sm text-gray-600",children:e.user_email})]})}),r.jsx("td",{className:"px-6 py-4 text-sm font-medium text-gray-900",children:k(e.plan_id)}),r.jsx("td",{className:"px-6 py-4",children:_(e.status)}),r.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:new Date(e.start_date).toLocaleDateString("ar-SA")}),r.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:e.end_date?new Date(e.end_date).toLocaleDateString("ar-SA"):"-"}),r.jsx("td",{className:"px-6 py-4",children:e.auto_renew?r.jsx("span",{className:"text-green-600 text-sm",children:"نعم"}):r.jsx("span",{className:"text-gray-400 text-sm",children:"لا"})}),r.jsx("td",{className:"px-6 py-4",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx("button",{onClick:()=>N(e.id),className:"p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors",title:"تجديد",children:r.jsx(o.Z,{className:"w-4 h-4"})}),r.jsx("button",{onClick:()=>w(e.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"إلغاء",children:r.jsx(x.Z,{className:"w-4 h-4"})})]})})]},e.id))})]})})})]})})}},53036:(e,t,s)=>{"use strict";s.d(t,{O:()=>r});let r=(0,s(78323).eI)("https://gigrtzamstdyynmvwljq.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdpZ3J0emFtc3RkeXlubXZ3bGpxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjIwMDg5MDMsImV4cCI6MjA3NzU4NDkwM30.OZMTpBkAK2Zc4m0CyOdBbHsoAV_MS7FK-OpQNvuxgmc")},41428:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});let r=(0,s(6913).createProxy)(String.raw`/workspace/socialpro-saas/app/admin/subscriptions/page.tsx#default`)},41287:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>i,metadata:()=>a});var r=s(50207);s(75210);let a={title:"SocialPro - أقوى منصة عربية للتسويق الإلكتروني",description:"أدِر حساباتك، أطلق حملاتك، وحلل نتائجك من مكان واحد. وفّر الوقت وضاعف نتائجك مع أدوات تسويقية احترافية."};function i({children:e}){return r.jsx("html",{lang:"ar",dir:"rtl",children:r.jsx("body",{className:"antialiased",children:e})})}},60291:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});var r=s(14793);let a=e=>[{type:"image/x-icon",sizes:"16x16",url:(0,r.fillMetadataSegment)(".",e.params,"favicon.ico")+""}]},75210:()=>{}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[799,943,793,550],()=>s(26287));module.exports=r})();